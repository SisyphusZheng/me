import{a as K,b as X,c as b,d as I,e as Y,f as z}from"./chunk-ESCFK4PK.js";import"./chunk-6RK4QHXZ.js";typeof globalThis>"u"&&(window.globalThis=window);var j="92bda090b9163317b8793a659e37220111fb5843";var J="/_frsh",G="__frsh_c";function k(t){if(!t.startsWith("/")||t.startsWith("//"))return t;try{let e=new URL(t,"https://freshassetcache.local");return e.protocol!=="https:"||e.host!=="freshassetcache.local"||e.searchParams.has(G)?t:(e.searchParams.set(G,j),e.pathname+e.search+e.hash)}catch(e){return console.warn(`Failed to create asset() URL, falling back to regular path ('${t}'):`,e),t}}function fe(t){if(t.includes("("))return t;let e=t.split(","),n=[];for(let o of e){let s=o.trimStart(),i=o.length-s.length;if(s==="")return t;let r=s.indexOf(" ");r===-1&&(r=s.length);let l=o.substring(0,i),a=s.substring(0,r),d=s.substring(r);n.push(l+k(a)+d)}return n.join(",")}function Q(t){if(t.type==="img"||t.type==="source"){let{props:e}=t;if(e["data-fresh-disable-lock"])return;typeof e.src=="string"&&(e.src=k(e.src)),typeof e.srcset=="string"&&(e.srcset=fe(e.srcset))}}var Z="fresh-partial",M="f-partial",P="f-loading",E="f-client-nav",q="data-fresh-key",_="data-current",L="data-ancestor";function $(t,e){let n=new URL(e,"http://localhost").pathname;return n!=="/"&&n.endsWith("/")&&(n=n.slice(0,-1)),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t===n?2:t.startsWith(n+"/")||n==="/"?1:0}function ee(t,e){let n=t.props,o=n.href;if(typeof o=="string"&&o.startsWith("/")){let s=$(e,o);s===2?(n[_]="true",n["aria-current"]="page"):s===1&&(n[L]="true",n["aria-current"]="true")}}function he(t,e,n){let o=t.__k={_frshRootFrag:!0,nodeType:1,parentNode:t,nextSibling:null,get firstChild(){let s=e.nextSibling;return s===n?null:s},get childNodes(){let s=[],i=e.nextSibling;for(;i!==null&&i!==n;)s.push(i),i=i.nextSibling;return s},insertBefore(s,i){t.insertBefore(s,i!=null?i:n)},appendChild(s){t.insertBefore(s,n)},removeChild(s){t.removeChild(s)},contains(s){if(s===null)return!1;let i=o.childNodes;for(let r=0;r<i.length;r++)if(i[r].contains(s))return!0;return!1}};return o}function se(t){return t.nodeType===Node.COMMENT_NODE}function pe(t){return t.nodeType===Node.TEXT_NODE}function ie(t){return t.nodeType===Node.ELEMENT_NODE&&!("_frshRootFrag"in t)}function Ue(t,e){let n=[];F(t,e,[],[b(I,null)],document.body,n);for(let o=0;o<n.length;o++){let{vnode:s,rootFragment:i}=n[o],r=()=>{z(s,i)};"scheduler"in window?scheduler.postTask(r):setTimeout(r,0)}}function le(t){return t.children}le.displayName="PreactServerComponent";function D(t,e){let n=t.props;n.children==null?n.children=e:Array.isArray(n.children)?n.children.push(e):n.children=[n.children,e]}var B=class extends Y{componentDidMount(){ae.set(this.props.name,this)}render(){return this.props.children}};var te=!1,ae=new Map;function v(t){let{startNode:e,endNode:n}=t,o=n.parentNode;if(!te&&e!==null&&e.nodeType===Node.COMMENT_NODE){let s=new Text("");t.startNode=s,o.insertBefore(s,e),e.remove()}if(!te&&n!==null&&n.nodeType===Node.COMMENT_NODE){let s=new Text("");t.endNode=s,o.insertBefore(s,n),n.remove()}}function ne(t,e,n,o,s,i){let[r,l]=s.slice(6).split(":"),a=`#frsh-slot-${r}-${l}-children`,d=document.querySelector(a);if(d!==null){n.push({kind:1,endNode:null,startNode:null,text:s.slice(1)});let c=d.content.cloneNode(!0);F(t,e,n,o,c,i),n.pop()}}function F(t,e,n,o,s,i){let r=s;for(;r!==null;){let l=n.length>0?n[n.length-1]:null;if(se(r)){let a=r.data;if(a.startsWith("!--")&&(a=a.slice(3,-2)),a.startsWith("frsh-slot"))n.push({startNode:r,text:a,endNode:null,kind:1}),o.push(b(le,{id:a}));else if(a.startsWith("frsh-partial")){let[d,c,f,m]=a.split(":");n.push({startNode:r,text:c,endNode:null,kind:2}),o.push(b(B,{name:c,key:m,mode:+f}))}else if(a.startsWith("frsh-key:")){let d=a.slice(9);o.push(b(I,{key:d}))}else if(a.startsWith("/frsh-key:")){let d=o.pop(),c=o[o.length-1];D(c,d),r=r.nextSibling;continue}else if(l!==null&&(a.startsWith("/frsh")||l.text===a)){if(l.endNode=r,n.pop(),l.kind===1){let d=o.pop(),c=o[o.length-1];c.props.children=d,v(l),r=l.endNode.nextSibling;continue}else if(l!==null&&(l.kind===0||l.kind===2))if(n.length===0){let d=o[o.length-1];d.props.children==null&&ne(t,e,n,o,a,i),o.pop();let c=r.parentNode;v(l);let f=he(c,l.startNode,l.endNode);i.push({vnode:d,marker:l,rootFragment:f}),r=l.endNode.nextSibling;continue}else{let d=o[o.length-1];d&&d.props.children==null?(ne(t,e,n,o,a,i),d.props.children==null&&o.pop()):o.pop(),l.endNode=r,v(l);let c=o[o.length-1];D(c,d),r=l.endNode.nextSibling;continue}}else if(a.startsWith("frsh")){let[d,c,f]=a.slice(5).split(":"),m=e[Number(c)];n.push({startNode:r,endNode:null,text:a,kind:0});let g=b(t[d],m);f&&(g.key=f),o.push(g)}}else if(pe(r)){let a=o[o.length-1];l!==null&&(l.kind===1||l.kind===2)&&D(a,r.data)}else{let a=o[o.length-1];if(ie(r))if(l!==null&&(l.kind===1||l.kind===2)){let c={children:r.childNodes.length<=1?null:[]},f=!1;for(let g=0;g<r.attributes.length;g++){let y=r.attributes[g];if(y.nodeName===q){f=!0,c.key=y.nodeValue;continue}else if(y.nodeName===P){let x=y.nodeValue,h=e[Number(x)][P].value;r._freshIndicator=h}c[y.nodeName]=typeof r[y.nodeName]=="boolean"?!0:y.nodeValue}f&&r.removeAttribute(q);let m=b(r.localName,c);D(a,m),o.push(m)}else{let d=r.getAttribute(P);if(d!==null){let c=e[Number(d)][P].value;r._freshIndicator=c}}r.firstChild&&r.nodeName!=="SCRIPT"&&F(t,e,n,o,r.firstChild,i),l!==null&&l.kind!==0&&o.pop()}r!==null&&(r=r.nextSibling)}}var me="Unable to process partial response.";async function U(t,e={}){e.redirect="follow",t.searchParams.set(Z,"true");let n=await fetch(t,e);await ge(n)}function de(t){document.querySelectorAll("a").forEach(e=>{let n=$(t.pathname,e.href);n===2?(e.setAttribute(_,"true"),e.setAttribute("aria-current","page"),e.removeAttribute(L)):n===1?(e.setAttribute(L,"true"),e.setAttribute("aria-current","true"),e.removeAttribute(_)):(e.removeAttribute(_),e.removeAttribute(L),e.removeAttribute("aria-current"))})}function ce(t,e,n,o){var l;let s=null,i=o.firstChild,r=0;for(;i!==null;){if(se(i)){let a=i.data;if(a.startsWith("frsh-partial"))s=i,r++;else if(a.startsWith("/frsh-partial")){r--;let d={_frshRootFrag:!0,nodeType:1,nextSibling:null,firstChild:s,parentNode:o,get childNodes(){let c=[s],f=s;for(;(f=f.nextSibling)!==null;)c.push(f);return c}};F(e,(l=n[0])!=null?l:[],[],[b(I,null)],d,t)}}else r===0&&ie(i)&&ce(t,e,n,i);i=i.nextSibling}}var V=class extends Error{};async function ge(t){var y,x;let e=t.headers.get("Content-Type"),n=t.headers.get("X-Fresh-UUID");if(e!=="text/html; charset=utf-8")throw new Error(me);let o=await t.text(),s=new DOMParser().parseFromString(o,"text/html"),i=[],r={},l=s.getElementById(`__FRSH_PARTIAL_DATA_${n}`),a=null;l!==null&&(a=JSON.parse(l.textContent),i.push(...Array.from(Object.entries(a.islands)).map(async h=>{let p=await import(`${h[1].url}`);r[h[0]]=p[h[1].export]})));let d=(y=s.getElementById(`__FRSH_STATE_${n}`))==null?void 0:y.textContent,c=[[],[]],f;a!==null&&a.signals!==null&&i.push(import(a.signals).then(h=>{f=h.signal}));let m;d&&a&&a.deserializer!==null&&i.push(import(a.deserializer).then(h=>m=h.deserialize)),await Promise.all(i),d&&(c=m?m(d,f):(x=JSON.parse(d))==null?void 0:x.v);let g=[];if(ce(g,r,c,s.body),g.length===0)throw new V(`Found no partials in HTML response. Please make sure to render at least one partial. Requested url: ${t.url}`);s.title&&(document.title=s.title),Array.from(s.head.childNodes).forEach(h=>{let p=h;if(p.nodeName!=="TITLE"){if(p.nodeName==="META"){let u=p;if(u.hasAttribute("charset"))return;let T=u.name;if(T!==""){let A=document.head.querySelector(`meta[name="${T}"]`);A!==null?A.content!==u.content&&(A.content=u.content):document.head.appendChild(u)}else{let A=p.getAttribute("property"),N=document.head.querySelector(`meta[property="${A}"]`);N!==null?N.content!==u.content&&(N.content=u.content):document.head.appendChild(u)}}else if(p.nodeName==="LINK"){let u=p;if(u.rel==="modulepreload")return;u.rel==="stylesheet"&&Array.from(document.head.querySelectorAll("link")).find(A=>A.href===u.href)===void 0&&document.head.appendChild(u)}else if(p.nodeName==="SCRIPT"){if(p.src===`${J}/refresh.js`)return}else if(p.nodeName==="STYLE"){let u=p;u.id===""&&document.head.appendChild(u)}}});for(let h=0;h<g.length;h++){let{vnode:p,marker:u}=g[h],T=ae.get(u.text);if(!T)console.warn(`Partial "${u.text}" not found. Skipping...`);else{let A=p.props.mode,N=p.props.children;if(A===0)T.props.children=N;else{let O=T.props.children,C=Array.isArray(O)?O:[O];if(A===1)C.push(N);else{X(N)||(N=b(I,null,N)),N.key==null&&(N.key=C.length);let W=T.__v.__k;if(Array.isArray(W))for(let R=0;R<W.length;R++){let w=W[R];if(w.key==null)w.key=R;else break}for(let R=0;R<C.length;R++){let w=C[R];if(w.key==null)w.key=R;else break}C.unshift(N)}T.props.children=C}T.setState({})}}}var re=K.vnode;K.vnode=t=>{if(Q(t),typeof t.type=="string"&&(t.type==="a"&&ee(t,location.pathname),E in t.props)){let e=t.props[E];typeof e=="boolean"&&(t.props[E]=String(e))}re&&re(t)};function S(t){if(t===null)return document.querySelector(`[${E}="true"]`)!==null;let e=t.closest(`[${E}]`);return e===null?!1:e.getAttribute(E)==="true"}var oe,H=((oe=history.state)==null?void 0:oe.index)||0;if(!history.state){let t={index:H,scrollX,scrollY};history.replaceState(t,document.title)}function ue(t){if(t.href!==globalThis.location.href){let e={index:H,scrollX:globalThis.scrollX,scrollY:globalThis.scrollY};history.replaceState({...e},"",location.href),H++,e.scrollX=0,e.scrollY=0,history.pushState(e,"",t.href)}}document.addEventListener("click",async t=>{var n;let e=t.target;if(e&&(e instanceof HTMLElement||e instanceof SVGElement)){let o=e;if(e.nodeName!=="A"&&(e=e.closest("a")),e===null&&(e=o.closest("button")),e&&e instanceof HTMLAnchorElement&&e.href&&(!e.target||e.target==="_self")&&e.origin===location.origin&&t.button===0&&!(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button)&&!t.defaultPrevented){let s=e.getAttribute(M);if((n=e.getAttribute("href"))!=null&&n.startsWith("#")||!S(e))return;let i=e._freshIndicator;i!==void 0&&(i.value=!0),t.preventDefault();let r=new URL(e.href);try{ue(r);let l=new URL(s||r.href,location.href);await U(l),de(r),scrollTo({left:0,top:0,behavior:"instant"})}finally{i!==void 0&&(i.value=!1)}}else if(e&&e instanceof HTMLButtonElement&&(e.type!=="submit"||e.form===null)){let s=e.getAttribute(M);if(s===null||!S(e))return;let i=new URL(s,location.href);await U(i)}}});addEventListener("popstate",async t=>{var s,i,r;if(t.state===null){history.scrollRestoration&&(history.scrollRestoration="auto");return}let e=history.state;if(H=(s=e.index)!=null?s:H+1,!S(null)){location.reload();return}history.scrollRestoration&&(history.scrollRestoration="manual");let o=new URL(location.href,location.origin);try{await U(o),de(o),scrollTo({left:(i=e.scrollX)!=null?i:0,top:(r=e.scrollY)!=null?r:0,behavior:"instant"})}catch(l){if(l instanceof V){location.reload();return}throw l}});document.addEventListener("submit",async t=>{var n,o,s,i,r,l,a,d;let e=t.target;if(e!==null&&e instanceof HTMLFormElement&&!t.defaultPrevented){if(!S(e)||t.submitter!==null&&!S(t.submitter))return;let c=(s=(o=(n=t.submitter)==null?void 0:n.getAttribute("formmethod"))==null?void 0:o.toLowerCase())!=null?s:e.method.toLowerCase();if(c!=="get"&&c!=="post"&&c!=="dialog")return;let f=(d=(a=(l=(i=t.submitter)==null?void 0:i.getAttribute(M))!=null?l:(r=t.submitter)==null?void 0:r.getAttribute("formaction"))!=null?a:e.getAttribute(M))!=null?d:e.action;if(f!==""){t.preventDefault();let m=new URL(f,location.href),g;c==="get"?new URLSearchParams(new FormData(e)).forEach((x,h)=>m.searchParams.set(h,x)):g={body:new FormData(e),method:c},ue(m),await U(m,g)}}});export{ge as applyPartials,Ue as revive};
