import{a,b as p,c as x,d as t}from"./chunk-67FELWPG.js";import{d as f}from"./chunk-ESCFK4PK.js";function w(){let[r,o]=a(""),[c,i]=a([]),[u,g]=a([]),[l,m]=a(!1),[h,v]=a(null),n=x(null);p(()=>{let e=localStorage.getItem("recentSearches");if(e)try{g(JSON.parse(e))}catch(s){console.error("\u89E3\u6790\u6700\u8FD1\u641C\u7D22\u6570\u636E\u5931\u8D25",s)}},[]);let b=e=>{if(!e||e.trim()==="")return;let s=[e,...u.filter(N=>N!==e)].slice(0,5);g(s),localStorage.setItem("recentSearches",JSON.stringify(s))};async function d(){if(!(!r||r.trim()==="")){m(!0),v(null);try{console.log("\u5F00\u59CB\u641C\u7D22:",r);let e=await fetch(`/api/search?q=${encodeURIComponent(r)}`);if(!e.ok)throw new Error(`\u641C\u7D22\u8BF7\u6C42\u5931\u8D25: ${e.status}`);let s=await e.json();s&&s.length>0?(i(s),b(r)):i([])}catch(e){console.error("\u641C\u7D22\u6267\u884C\u9519\u8BEF:",e),v("\u641C\u7D22\u8FC7\u7A0B\u4E2D\u53D1\u751F\u9519\u8BEF")}finally{m(!1)}}}let y=e=>{o(e),n.current.value=e,d()};return t("div",{className:"w-full max-w-3xl mx-auto",children:[t("div",{className:"relative flex items-center mb-6",children:[t("input",{ref:n,type:"text",placeholder:"\u641C\u7D22\u5185\u5BB9...",className:"w-full p-3 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:e=>o(e.target.value),onKeyDown:e=>e.key==="Enter"&&d()}),r&&t(f,{children:t("button",{onClick:()=>{o(""),i([]),n.current&&(n.current.value="",n.current.focus())},className:"absolute right-14 text-gray-500 hover:text-gray-700","aria-label":"\u6E05\u7A7A\u641C\u7D22",children:t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:t("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})}),t("button",{onClick:d,disabled:l,className:"absolute right-3 text-blue-500 hover:text-blue-700","aria-label":"\u641C\u7D22",children:t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),h&&t("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:h}),l&&t("div",{className:"flex justify-center my-8",children:t("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),!l&&c.length>0&&t("div",{className:"space-y-6",children:[t("h2",{className:"text-xl font-semibold",children:["\u641C\u7D22\u7ED3\u679C (",c.length,")"]}),t("div",{className:"divide-y divide-gray-200",children:c.map(e=>{var s;return t("div",{className:"py-4",children:t("a",{href:e.url,className:"block hover:bg-gray-50 rounded-lg p-3 -mx-3 transition-colors",children:[t("h3",{className:"text-lg font-medium text-blue-600",children:e.title}),t("p",{className:"text-sm text-gray-500",children:e.url}),t("p",{className:"mt-1 text-gray-700",children:((s=e.highlights)==null?void 0:s[0])||e.excerpt})]})},e.id)})})]}),!l&&r&&c.length===0&&t("div",{className:"text-center py-8",children:[t("p",{className:"text-gray-600",children:['\u6CA1\u6709\u627E\u5230\u4E0E "',r,'" \u76F8\u5173\u7684\u7ED3\u679C']}),t("p",{className:"text-sm text-gray-500 mt-2",children:"\u5C1D\u8BD5\u4F7F\u7528\u4E0D\u540C\u7684\u5173\u952E\u8BCD\u6216\u66F4\u7B80\u77ED\u7684\u641C\u7D22\u8BCD"})]}),!l&&!r&&u.length>0&&t("div",{className:"mt-4",children:[t("h3",{className:"text-lg font-medium mb-2",children:"\u6700\u8FD1\u641C\u7D22"}),t("div",{className:"flex flex-wrap gap-2",children:u.map((e,s)=>t("button",{onClick:()=>y(e),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-sm",children:e},s))})]})]})}export{w as a};
